{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":true,"separator":"[\\s\\-\\.]+"},"docs":[{"location":"","text":"Tez: a simple pytorch trainer Documentation : https://tez.readthedocs.io Source Code : https://github.com/abhi1thakur/tez tez (\u0924\u0947\u091c\u093c / \u062a\u06cc\u0632) means sharp, fast & active. This is a simple, to-the-point, library to make your pytorch training easy. Idea around tez is simple: keep things as simple as possible make it as customizable as possible clean code faster prototyping production ready Currently, tez supports cpu and gpu training. More coming soon! Installation $ pip install tez","title":"Tez"},{"location":"#installation","text":"$ pip install tez","title":"Installation"},{"location":"GettingStarted/","text":"Getting started Tez is a simple pytorch trainer to make your life easy. It comes with some useful dataset classes and callbacks. Instead of inheriting from nn.Module, we inherit from tez.Model. import tez class MyModel ( tez . Model ): def __init__ ( self ): super () . __init__ () # do something here def forward ( self , arg1 , arg2 ): # do something here return outputs , loss , metrics In Tez, the dataset class and model\u2019s forward function are closely related. The output names from dataset class must be same as the input arguments in forward function of the model. example import tez class MyModel ( tez . Model ): def __init__ ( self ): super () . __init__ () . . # tell when to step the scheduler self . step_scheduler_after = \"batch\" def monitor_metrics ( self , outputs , targets ): outputs = torch . sigmoid ( outputs ) . cpu () . detach () . numpy () >= 0.5 targets = targets . cpu () . detach () . numpy () accuracy = metrics . accuracy_score ( targets , outputs ) return { \"accuracy\" : accuracy } def fetch_scheduler ( self ): # create your own scheduler def fetch_optimizer ( self ): # create your own optimizer def forward ( self , ids , mask , token_type_ids , targets ): _ , o_2 = self . bert ( ids , attention_mask = mask , token_type_ids = token_type_ids ) b_o = self . bert_drop ( o_2 ) output = self . out ( b_o ) # calculate loss here loss = nn . BCEWithLogitsLoss ()( output , targets ) # calculate the metric dictionary here metric_dict = self . monitor_metrics ( output , targets ) return output , loss , metric_dict","title":"Getting started"},{"location":"GettingStarted/#getting-started","text":"Tez is a simple pytorch trainer to make your life easy. It comes with some useful dataset classes and callbacks. Instead of inheriting from nn.Module, we inherit from tez.Model. import tez class MyModel ( tez . Model ): def __init__ ( self ): super () . __init__ () # do something here def forward ( self , arg1 , arg2 ): # do something here return outputs , loss , metrics In Tez, the dataset class and model\u2019s forward function are closely related. The output names from dataset class must be same as the input arguments in forward function of the model.","title":"Getting started"},{"location":"GettingStarted/#example","text":"import tez class MyModel ( tez . Model ): def __init__ ( self ): super () . __init__ () . . # tell when to step the scheduler self . step_scheduler_after = \"batch\" def monitor_metrics ( self , outputs , targets ): outputs = torch . sigmoid ( outputs ) . cpu () . detach () . numpy () >= 0.5 targets = targets . cpu () . detach () . numpy () accuracy = metrics . accuracy_score ( targets , outputs ) return { \"accuracy\" : accuracy } def fetch_scheduler ( self ): # create your own scheduler def fetch_optimizer ( self ): # create your own optimizer def forward ( self , ids , mask , token_type_ids , targets ): _ , o_2 = self . bert ( ids , attention_mask = mask , token_type_ids = token_type_ids ) b_o = self . bert_drop ( o_2 ) output = self . out ( b_o ) # calculate loss here loss = nn . BCEWithLogitsLoss ()( output , targets ) # calculate the metric dictionary here metric_dict = self . monitor_metrics ( output , targets ) return output , loss , metric_dict","title":"example"}],"index":{"fieldVectors":[["title/",[0,0.084]],["text/",[0,0.141,1,0.989,2,0.848,3,0.66,4,1.697,5,0.172,6,1.697,7,1.697,8,1.697,9,1.697,10,2.181,11,1.697,12,1.697,13,1.697,14,1.697,15,1.697,16,1.697,17,1.697,18,1.697,19,0.848,20,2.181,21,0.66,22,1.697,23,1.697,24,1.697,25,1.697,26,2.181,27,1.697,28,1.697,29,1.697,30,1.697,31,1.697,32,1.697,33,1.697,34,1.697,35,0.66,36,1.697,37,1.697,38,0.66,39,1.697,40,0.848,41,1.072]],["title/#installation",[40,0.61]],["text/#installation",[0,0.122,5,0.144,40,0.89,41,1.445]],["title/GettingStarted/",[42,0.459,43,0.459]],["text/GettingStarted/",[0,0.123,1,0.36,2,0.36,3,0.36,5,0.186,19,0.36,21,0.36,35,0.552,38,0.36,42,0.36,43,0.36,44,0.584,45,0.584,46,1.091,47,0.812,48,0.584,49,0.584,50,0.896,51,0.552,52,0.584,53,0.753,54,0.552,55,0.552,56,0.893,57,0.753,58,0.995,59,0.552,60,0.896,61,0.753,62,0.753,63,0.584,64,0.584,65,0.672,66,0.964,67,0.753,68,0.672,69,0.584,70,0.896,71,0.584,72,0.584,73,0.584,74,0.584,75,0.584,76,0.584,77,0.584,78,0.584,79,0.584,80,0.896,81,0.584,82,0.584,83,0.896,84,1.45,85,0.584,86,0.584,87,0.896,88,0.896,89,0.584,90,0.584,91,1.091,92,0.584,93,0.584,94,0.896,95,0.584,96,0.584,97,0.896,98,0.896,99,1.091,100,0.584,101,0.896,102,0.584,103,0.584,104,0.896,105,0.584,106,0.584,107,0.896,108,0.584,109,0.584,110,0.896]],["title/GettingStarted/#getting-started",[42,0.459,43,0.459]],["text/GettingStarted/#getting-started",[0,0.138,1,0.62,2,0.62,3,0.62,5,0.18,19,0.62,21,0.62,38,0.62,44,1.008,45,1.008,46,1.477,47,0.966,48,1.008,49,1.008,50,1.323,51,0.62,52,1.008,53,0.909,54,0.62,55,0.62,56,0.815,57,0.815,58,0.815,59,0.62,60,1.323,61,0.815,62,0.909,63,1.008,64,1.008,65,0.62,66,0.815,67,0.62,68,0.62,69,1.008,70,1.323,71,1.008,72,1.008,73,1.008,74,1.008,75,1.008,76,1.008]],["title/GettingStarted/#example",[77,0.991]],["text/GettingStarted/#example",[0,0.089,5,0.187,35,0.648,47,0.446,51,0.446,53,0.446,54,0.446,55,0.446,56,0.89,57,0.648,58,1.017,59,0.446,61,0.648,62,0.446,65,0.648,66,0.982,67,0.763,68,0.648,78,0.724,79,0.724,80,1.052,81,0.724,82,0.724,83,1.052,84,1.557,85,0.724,86,0.724,87,1.052,88,1.052,89,0.724,90,0.724,91,1.24,92,0.724,93,0.724,94,1.052,95,0.724,96,0.724,97,1.052,98,1.052,99,1.24,100,0.724,101,1.052,102,0.724,103,0.724,104,1.052,105,0.724,106,0.724,107,1.052,108,0.724,109,0.724,110,1.052]]],"fields":["title","text"],"invertedIndex":[["",{"_index":5,"text":{"":{},"#installation":{},"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["0",{"_index":89,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["5",{"_index":90,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["_",{"_index":100,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["__init__",{"_index":57,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["accuraci",{"_index":91,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["accuracy_scor",{"_index":92,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["activ",{"_index":16,"text":{"":{}},"title":{}}],["arg1",{"_index":63,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["arg2",{"_index":64,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["argument",{"_index":76,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["around",{"_index":23,"text":{"":{}},"title":{}}],["attention_mask",{"_index":103,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["b_o",{"_index":104,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["batch",{"_index":82,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["bcewithlogitsloss",{"_index":108,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["bert",{"_index":102,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["bert_drop",{"_index":105,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["calcul",{"_index":107,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["callback",{"_index":48,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["class",{"_index":47,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["clean",{"_index":28,"text":{"":{}},"title":{}}],["close",{"_index":71,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["code",{"_index":10,"text":{"":{}},"title":{}}],["com/abhi1thakur/tez",{"_index":12,"text":{"":{}},"title":{}}],["come",{"_index":38,"text":{"":{},"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["cpu",{"_index":35,"text":{"":{},"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["creat",{"_index":94,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["current",{"_index":33,"text":{"":{}},"title":{}}],["customiz",{"_index":27,"text":{"":{}},"title":{}}],["dataset",{"_index":46,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["def",{"_index":56,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["detach",{"_index":87,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["dictionari",{"_index":109,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["document",{"_index":4,"text":{"":{}},"title":{}}],["easi",{"_index":21,"text":{"":{},"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["exampl",{"_index":77,"text":{"GettingStarted/":{}},"title":{"GettingStarted/#example":{}}}],["fast",{"_index":15,"text":{"":{}},"title":{}}],["faster",{"_index":29,"text":{"":{}},"title":{}}],["fetch_optim",{"_index":95,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["fetch_schedul",{"_index":93,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["forward",{"_index":62,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["function",{"_index":70,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["get",{"_index":42,"text":{"GettingStarted/":{}},"title":{"GettingStarted/":{},"GettingStarted/#getting-started":{}}}],["gpu",{"_index":36,"text":{"":{}},"title":{}}],["here",{"_index":61,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["https://github",{"_index":11,"text":{"":{}},"title":{}}],["https://tez",{"_index":6,"text":{"":{}},"title":{}}],["id",{"_index":97,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["idea",{"_index":22,"text":{"":{}},"title":{}}],["import",{"_index":54,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["inherit",{"_index":50,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["input",{"_index":75,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["instal",{"_index":40,"text":{"":{},"#installation":{}},"title":{"#installation":{}}}],["instead",{"_index":49,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["io",{"_index":8,"text":{"":{}},"title":{}}],["keep",{"_index":24,"text":{"":{}},"title":{}}],["librari",{"_index":18,"text":{"":{}},"title":{}}],["life",{"_index":44,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["loss",{"_index":67,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["make",{"_index":19,"text":{"":{},"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["mask",{"_index":98,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["mean",{"_index":13,"text":{"":{}},"title":{}}],["metric",{"_index":68,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["metric_dict",{"_index":110,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["model",{"_index":53,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["model\u2019",{"_index":69,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["modul",{"_index":52,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["monitor_metr",{"_index":83,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["more",{"_index":37,"text":{"":{}},"title":{}}],["mymodel",{"_index":55,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["name",{"_index":73,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["nn",{"_index":51,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["numpi",{"_index":88,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["o_2",{"_index":101,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["optim",{"_index":96,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["out",{"_index":106,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["output",{"_index":66,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["pip",{"_index":41,"text":{"":{},"#installation":{}},"title":{}}],["point",{"_index":17,"text":{"":{}},"title":{}}],["possibl",{"_index":26,"text":{"":{}},"title":{}}],["product",{"_index":31,"text":{"":{}},"title":{}}],["prototyp",{"_index":30,"text":{"":{}},"title":{}}],["pytorch",{"_index":2,"text":{"":{},"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["readi",{"_index":32,"text":{"":{}},"title":{}}],["readthedoc",{"_index":7,"text":{"":{}},"title":{}}],["relat",{"_index":72,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["return",{"_index":65,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["same",{"_index":74,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["schedul",{"_index":80,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["self",{"_index":58,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["sharp",{"_index":14,"text":{"":{}},"title":{}}],["sigmoid",{"_index":86,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["simpl",{"_index":1,"text":{"":{},"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["someth",{"_index":60,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["soon",{"_index":39,"text":{"":{}},"title":{}}],["sourc",{"_index":9,"text":{"":{}},"title":{}}],["start",{"_index":43,"text":{"GettingStarted/":{}},"title":{"GettingStarted/":{},"GettingStarted/#getting-started":{}}}],["step",{"_index":79,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["step_scheduler_aft",{"_index":81,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["super",{"_index":59,"text":{"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{}}],["support",{"_index":34,"text":{"":{}},"title":{}}],["target",{"_index":84,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["tell",{"_index":78,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["tez",{"_index":0,"text":{"":{},"#installation":{},"GettingStarted/":{},"GettingStarted/#example":{},"GettingStarted/#getting-started":{}},"title":{"":{}}}],["thing",{"_index":25,"text":{"":{}},"title":{}}],["token_type_id",{"_index":99,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["torch",{"_index":85,"text":{"GettingStarted/":{},"GettingStarted/#example":{}},"title":{}}],["train",{"_index":20,"text":{"":{}},"title":{}}],["trainer",{"_index":3,"text":{"":{},"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}],["us",{"_index":45,"text":{"GettingStarted/":{},"GettingStarted/#getting-started":{}},"title":{}}]],"pipeline":["stemmer"],"version":"2.3.8"}}